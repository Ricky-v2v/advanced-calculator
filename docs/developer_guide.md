
```markdown
# 计算器开发者指南

## 项目结构
```bash
Calculator/
├── calculator_cli.py    # 命令行界面实现
├── gui_calculator.py    # 图形界面实现
├── unit_converter.py    # 单位转换功能
├── config.yaml         # 配置文件
├── build.py           # 构建脚本
├── tests/            # 测试目录
├── i18n/             # 国际化文件
└── utils/            # 工具函数
    ├── logger.py     # 日志处理
    └── version_checker.py  # 版本检查
 ```

## 核心组件
### CalculatorCore
- 负责所有计算逻辑
- 支持基本运算、科学函数和复数运算
- 使用装饰器进行错误处理
示例：添加新运算符

```python
# 在 OPERATORS 字典中添加新运算符
OPERATORS = {
    # ... 现有运算符 ...
    '**': lambda a, b: pow(a, b),  # 添加新的幂运算
}
 ```

### HistoryManager
- 管理计算历史记录
- 支持持久化存储（JSON格式）
- 提供历史记录搜索和过滤功能
- 自动限制历史记录数量
### CalculatorUI
- 处理用户输入输出
- 支持命令自动补全
- 提供多行输入模式
- 支持彩色输出（使用 colorama）
## 开发指南
### 添加新功能
1. 遵循现有代码结构和风格
2. 使用类型提示和文档字符串
3. 添加适当的错误处理
4. 更新配置文件（如需要）
5. 添加单元测试
### 错误处理规范
```python
@handle_errors
def new_function():
    """添加新函数时的错误处理示例"""
    if error_condition:
        raise ValueError("具体错误信息")
    return result
 ```

### 国际化支持
1. 在 i18n/ 目录下添加新的语言文件
2. 使用 Translator 类处理翻译
3. 所有用户界面文本都应支持翻译
### 测试规范
1. 使用 pytest 框架
2. 测试文件命名：test_*.py
3. 测试覆盖率要求：>80%
4. 包含正常和异常情况的测试用例
### 构建和部署
1. 使用 PyInstaller 打包
2. 支持跨平台构建
3. 自动版本检查和更新
## 代码风格指南
- 遵循 PEP 8 规范
- 使用有意义的变量名
- 添加适当的注释和文档
- 保持函数简短，单一职责
## 版本控制
- 使用语义化版本号
- 保持更新日志（CHANGELOG.md）
- 创建有意义的提交信息
## 性能优化建议
1. 使用适当的数据结构
2. 避免重复计算
3. 合理使用缓存
4. 注意内存管理
## 调试技巧
1. 使用内置的日志系统
2. 设置适当的日志级别
3. 使用断点调试
4. 检查异常堆栈
## 安全考虑
1. 输入验证和清理
2. 安全的文件操作
3. 错误信息处理
4. 配置文件保护